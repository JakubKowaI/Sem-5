using Plots

# dane (można wkleić je ręcznie lub wczytać z pliku)
h = [
1.0, 0.5, 0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125, 0.00390625, 0.001953125,
0.0009765625, 0.00048828125, 0.000244140625, 0.0001220703125, 6.103515625e-5, 3.0517578125e-5,
1.52587890625e-5, 7.62939453125e-6, 3.814697265625e-6, 1.9073486328125e-6,
9.5367431640625e-7, 4.76837158203125e-7, 2.384185791015625e-7, 1.1920928955078125e-7,
5.960464477539063e-8, 2.9802322387695312e-8, 1.4901161193847656e-8, 7.450580596923828e-9,
3.725290298461914e-9, 1.862645149230957e-9, 9.313225746154785e-10, 4.656612873077393e-10,
2.3283064365386963e-10, 1.1641532182693481e-10, 5.820766091346741e-11, 2.9103830456733704e-11,
1.4551915228366852e-11, 7.275957614183426e-12, 3.637978807091713e-12, 1.8189894035458565e-12,
9.094947017729282e-13, 4.547473508864641e-13, 2.2737367544323206e-13, 1.1368683772161603e-13,
5.684341886080802e-14, 2.842170943040401e-14, 1.4210854715202004e-14, 7.105427357601002e-15,
3.552713678800501e-15, 1.7763568394002505e-15, 8.881784197001252e-16, 4.440892098500626e-16,
2.220446049250313e-16, 1.1102230246251565e-16, 5.551115123125783e-17
]

error = [
1.9010469435800585, 1.753499116243109, 0.9908448135457593, 0.5062989976090435, 0.253457784514981,
0.1265007927090087, 0.0631552816187897, 0.03154911368255764, 0.015766832591977753, 0.007881411252170345,
0.0039401951225235265, 0.001969968780300313, 0.0009849520504721099, 0.0004924679222275685,
0.0002462319323930373, 0.00012311545724141837, 6.155759983439424e-5, 3.077877117529937e-5,
1.5389378673624776e-5, 7.694675146829866e-6, 3.8473233834324105e-6, 1.9235601902423127e-6,
9.612711400208696e-7, 4.807086915192826e-7, 2.394961446938737e-7, 1.1656156484463054e-7,
5.6956920069239914e-8, 3.460517827846843e-8, 4.802855890773117e-9, 5.480178888461751e-8,
1.1440643366000813e-7, 1.1440643366000813e-7, 3.5282501276157063e-7, 8.296621709646956e-7,
8.296621709646956e-7, 2.7370108037771956e-6, 1.0776864618478044e-6, 1.4181102600652196e-5,
1.0776864618478044e-6, 5.9957469788152196e-5, 0.0001209926260381522, 1.0776864618478044e-6,
0.0002430629385381522, 0.0007313441885381522, 0.0002452183114618478, 0.003661031688538152,
0.007567281688538152, 0.007567281688538152, 0.023192281688538152, 0.008057718311461848,
0.11694228168853815, 0.11694228168853815, 0.6169422816885382, 0.11694228168853815, 0.11694228168853815
]

# wykres w skali log-log (często używany przy analizie błędów)
plot(h, error,
    xscale = :log10,
    yscale = :log10,
    xlabel = "h",
    ylabel = "|błąd|",
    title = "Błąd przybliżenia pochodnej dla f(x) = sin(x) + cos(3x)",
    legend = false,
    linewidth = 2,
    marker = :circle,
)

# zaznaczenie minimalnego błędu
min_idx = argmin(error)
scatter!([h[min_idx]], [error[min_idx]], color=:red, label="min error")
annotate!([(h[min_idx], error[min_idx], text("min error", :red, 8))])
